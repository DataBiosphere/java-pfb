plugins {
    id 'com.srcclr.gradle'
    id 'maven-publish'
    id 'com.jfrog.artifactory'
    id 'bio.terra.pfb.java-library-conventions'
    id 'com.github.davidmc24.gradle.plugin.avro' version '1.8.0'
}

repositories {
    maven {
        // Terra proxy for maven central
        url 'https://broadinstitute.jfrog.io/broadinstitute/maven-central/'
    }
    mavenCentral()
    maven {
        url 'https://broadinstitute.jfrog.io/broadinstitute/libs-release/'
    }
    maven {
        url 'https://broadinstitute.jfrog.io/broadinstitute/libs-release-local/'
    }
}

dependencies {
    implementation "org.apache.avro:avro:1.11.2"
    testImplementation 'org.json:json:20230618'
    testImplementation 'com.fasterxml.jackson.core:jackson-databind:2.15.2'
}

sourceSets.main.java.srcDirs += ["${buildDir}/generated-src"]

generateAvroJava {
    source("library/src/main/avro") // TODO - try putting back in resources
    outputDir = file("build/generated-src")
}
compileJava.dependsOn generateAvroJava

apply from: 'generators.gradle'
apply from: "publishing.gradle"

srcclr {
    scope = "runtimeClasspath"
}